{"ast":null,"code":"var _jsxFileName = \"D:\\\\Amovie\\\\Amovie\\\\movie-react\\\\src\\\\components\\\\MovieComponent\\\\MovieDetails.tsx\",\n    _s = $RefreshSig$();\n\nimport \"../../styles/moviedetails.scss\";\nimport moment from \"moment\";\nimport useFetch from \"../../hooks/useFetch\";\nimport { useState } from \"react\";\nimport { AddReview } from \"./AddReview\";\nimport { Typography } from \"@mui/material\";\nimport { Link } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function MovieDetails() {\n  _s();\n\n  const [open, setOpen] = useState(false);\n  const url = \"http://localhost:7063/api/movies/\" + window.location.pathname.substring(window.location.pathname.lastIndexOf(\"/\") + 1);\n  const {\n    data: movie,\n    error,\n    loading\n  } = useFetch(url);\n  let reviewContent;\n  const userRole = localStorage.getItem(\"role\");\n\n  if (userRole === \"user\" || userRole === \"admin\") {\n    reviewContent = /*#__PURE__*/_jsxDEV(AddReview, {\n      open: open,\n      setOpen: setOpen\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 23,\n      columnNumber: 21\n    }, this);\n  } else {\n    reviewContent = /*#__PURE__*/_jsxDEV(Typography, {\n      sx: {\n        mt: 2\n      },\n      style: {\n        color: \"#F95252\"\n      },\n      children: [\"* You need to\", /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/signin\",\n        children: \" Sign in\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 27,\n        columnNumber: 22\n      }, this), \" first!\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 26,\n      columnNumber: 7\n    }, this);\n  }\n\n  const deleteReview = async id => {\n    const url = `http://localhost:7063/api/deletereview/${id}`;\n    await fetch(url, {\n      method: \"DELETE\"\n    }).then(async response => {\n      if (response.ok) {}\n    }).catch(error => {\n      console.warn(\"There was an error!\", error);\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: [loading && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Loading data...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 19\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"single-block\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"image-block\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: movie === null || movie === void 0 ? void 0 : movie.image,\n          alt: movie === null || movie === void 0 ? void 0 : movie.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 51,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"details-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: movie === null || movie === void 0 ? void 0 : movie.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"date\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              children: moment(movie === null || movie === void 0 ? void 0 : movie.release).format(\"YYYY\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 57,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 56,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [movie === null || movie === void 0 ? void 0 : movie.duration, \" min\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 60,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 59,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"IMDb \", /*#__PURE__*/_jsxDEV(\"span\", {\n                children: movie === null || movie === void 0 ? void 0 : movie.rating\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 64,\n                columnNumber: 22\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 63,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 62,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 55,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"description\",\n          children: movie === null || movie === void 0 ? void 0 : movie.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"details\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"names\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Country:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 71,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Genre:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 72,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Actors:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 73,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Budget:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 74,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 70,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"dates\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: movie === null || movie === void 0 ? void 0 : movie.country\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 78,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: movie === null || movie === void 0 ? void 0 : movie.genres.join(\", \")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 79,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: movie === null || movie === void 0 ? void 0 : movie.actors.join(\", \")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 80,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"$\", movie === null || movie === void 0 ? void 0 : movie.budget, \" mln\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 81,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"reviews-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Reviews\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"button\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setOpen(!open),\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Add review\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: open && reviewContent\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }, this), movie && (movie === null || movie === void 0 ? void 0 : movie.reviews.map(review => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"review\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"user\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: review.user\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"dot\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 102,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: moment(review.date).format(\"LLL\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 103,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            children: review.content\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 19\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 17\n        }, this), userRole === \"admin\" ? /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => deleteReview(review.id),\n            children: \"Delete\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 19\n        }, this) : \"\"]\n      }, review.content, true, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 15\n      }, this)).reverse())]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }, this), error && JSON.stringify(error)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 47,\n    columnNumber: 5\n  }, this);\n}\n\n_s(MovieDetails, \"wUKTt61C4FIfgLoVY/ERgnG+HFE=\", false, function () {\n  return [useFetch];\n});\n\n_c = MovieDetails;\n\nvar _c;\n\n$RefreshReg$(_c, \"MovieDetails\");","map":{"version":3,"sources":["D:/Amovie/Amovie/movie-react/src/components/MovieComponent/MovieDetails.tsx"],"names":["moment","useFetch","useState","AddReview","Typography","Link","MovieDetails","open","setOpen","url","window","location","pathname","substring","lastIndexOf","data","movie","error","loading","reviewContent","userRole","localStorage","getItem","mt","color","deleteReview","id","fetch","method","then","response","ok","catch","console","warn","image","title","release","format","duration","rating","description","country","genres","join","actors","budget","reviews","map","review","user","date","content","reverse","JSON","stringify"],"mappings":"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","sourcesContent":["import \"../../styles/moviedetails.scss\";\nimport moment from \"moment\";\nimport useFetch from \"../../hooks/useFetch\";\nimport { MovieType } from \"../../Types/Types\";\nimport { useState } from \"react\";\nimport { AddReview } from \"./AddReview\";\nimport { Typography } from \"@mui/material\";\nimport { Link } from \"react-router-dom\";\n\nexport default function MovieDetails() {\n  const [open, setOpen] = useState(false);\n  const url =\n    \"http://localhost:7063/api/movies/\" +\n    window.location.pathname.substring(\n      window.location.pathname.lastIndexOf(\"/\") + 1\n    );\n  const { data: movie, error, loading } = useFetch<MovieType>(url);\n\n  let reviewContent;\n  const userRole = localStorage.getItem(\"role\");\n\n  if (userRole === \"user\" || userRole === \"admin\") {\n    reviewContent = <AddReview open={open} setOpen={setOpen} />;\n  } else {\n    reviewContent = (\n      <Typography sx={{ mt: 2 }} style={{ color: \"#F95252\" }}>\n        * You need to<Link to=\"/signin\"> Sign in</Link> first!\n      </Typography>\n    );\n  }\n\n  const deleteReview = async (id: number) => {\n    const url = `http://localhost:7063/api/deletereview/${id}`;\n    await fetch(url, {\n      method: \"DELETE\",\n    })\n      .then(async (response) => {\n        if (response.ok) {\n        }\n      })\n      .catch((error) => {\n        console.warn(\"There was an error!\", error);\n      });\n  };\n\n  return (\n    <div className=\"container\">\n      {loading && <p>Loading data...</p>}\n      <div className=\"single-block\">\n        <div className=\"image-block\">\n          <img src={movie?.image} alt={movie?.title} />\n        </div>\n        <div className=\"details-container\">\n          <h2>{movie?.title}</h2>\n          <div className=\"date\">\n            <div>\n              <p>{moment(movie?.release).format(\"YYYY\")}</p>\n            </div>\n            <div>\n              <p>{movie?.duration} min</p>\n            </div>\n            <div>\n              <p>\n                IMDb <span>{movie?.rating}</span>\n              </p>\n            </div>\n          </div>\n          <p className=\"description\">{movie?.description}</p>\n          <div className=\"details\">\n            <div className=\"names\">\n              <p>Country:</p>\n              <p>Genre:</p>\n              <p>Actors:</p>\n              <p>Budget:</p>\n            </div>\n\n            <div className=\"dates\">\n              <p>{movie?.country}</p>\n              <p>{movie?.genres.join(\", \")}</p>\n              <p>{movie?.actors.join(\", \")}</p>\n              <p>${movie?.budget} mln</p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"reviews-container\">\n        <h2>Reviews</h2>\n        <div className=\"button\">\n          <button onClick={() => setOpen(!open)}>\n            <p>Add review</p>\n          </button>\n        </div>\n        <div>{open && reviewContent}</div>\n        {movie &&\n          movie?.reviews\n            .map((review) => (\n              <div className=\"review\" key={review.content}>\n                <div className=\"user\">\n                  <p>{review.user}</p>\n                  <div>\n                    <span className=\"dot\"></span>\n                    <p>{moment(review.date).format(\"LLL\")}</p>\n                  </div>\n                </div>\n                <div className=\"text\">\n                  <p>{review.content}</p>\n                </div>\n                {userRole === \"admin\" ? (\n                  <div>\n                    {/* <button>\n                      <Link to={`/update/${review.id}`}>Update</Link>\n                    </button> */}\n                    <button onClick={() => deleteReview(review.id)}>\n                      Delete\n                    </button>\n                  </div>\n                ) : (\n                  \"\"\n                )}\n              </div>\n            ))\n            .reverse()}\n      </div>\n      {error && JSON.stringify(error)}\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}